<script>
  $(function () {
    function loadTrash() {
      return new Promise((resolve, reject) => {
        google.script.run.withSuccessHandler(content => {
          let trashList = JSON.parse(content)
          trashListElement.empty()

          trashList.forEach(trashed => {
            let trashRowHtml = ejs.render(trashRowTemplate, trashed, {delimiter: '?'});
            trashListElement.append(trashRowHtml)
          })

          $(document).trigger('search.refresh')

          resolve(content)
        }).withFailureHandler(error => {
          reject(error)
        }).getTrashStringified();
      })
    }

    loadTrash()
  })
</script>